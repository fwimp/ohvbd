#' @title Get VecTraits dataset by ID
#' @description Retrieve a single VecTraits dataset specified by its dataset ID.
#' @author Francis Windram
#'
#' @param id_to_find a numeric ID indicating the particular dataset to download
#' @param basereq an httr2 request object, as generated by [ohvbd::generate_vb_basereq()]
#'
#' @return Returns a named list of two parts:
#'
#' `$status` being the status code associated with the request
#'
#' `$data` being the parsed JSON data from the response.
#'
#' @examples
#' \dontrun{
#' req <- generate_vb_basereq()
#' get_vt_dataset_byid(54, req)
#' }
#'
#' @export
#'

get_vt_dataset_byid <-
function(id_to_find, basereq){
  resp <- tryCatch({
    resp <- basereq %>%
    req_url_path_append("vectraits-dataset") %>%
    req_url_path_append(id_to_find) %>%
    req_url_query("format" = "json") %>%
    req_perform()
    resp
  }, error = function(e){
    # Get the last response instead
    last_response()
  })

  # Extract status code and json
  statuscode <- resp$status_code
  res <- resp %>% resp_body_json()

  return(list(status=statuscode, data=res))
}
